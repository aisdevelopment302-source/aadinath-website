# Implementation Plan ‚Äî Feb 9, 2026

**Session:** Planning Phase  
**Owner:** Forge + Adi  
**Target Completion:** 2026-02-23

---

## üìã Changes Overview

This plan covers **4 major changes** to ais-website:

1. **Remove Batch Generation System** (simplification)
2. **Replace Custom SVGs** (UI/UX improvement)
3. **Build Analytics Dashboard** (core new feature)
4. **Fix Security Issue** (firebase keys)

---

## üéØ Change 1: Remove Batch System

### Current State
- Docs mention batch ID generation: `BATCH-YYYY-MM-DD-XXX`
- QR verification page accepts `?batch=BATCH-ID` parameter
- Analytics tracks batch information
- Production system (ERP) hasn't been built yet

### Problem
- Not implemented in production yet
- Adds complexity to QR code generation
- Not needed for MVP (verify page works without it)
- Defers full implementation unnecessarily

### Decision: Remove it
- Keep QR static for now (just links to `/verify` with no batch param)
- Still log all verify page visits (but without batch tracking)
- Can add batch system later when ERP is ready

### Changes Required

#### In `VERIFICATION_SETUP.md`
- [ ] Remove all references to `BATCH-YYYY-MM-DD-XXX` format
- [ ] Simplify QR URL to: `https://aadinathindustries.in/verify`
- [ ] Update "Next Steps" section (remove batch ID generation)
- [ ] Keep QR code generation instructions, but mark as "static for now"

#### In `PROGRESS.md`
- [ ] Remove batch ID generation as a blocker item
- [ ] Remove "Batch ID Generation in AIS ERP" from timeline
- [ ] Simplify "In Progress" section
- [ ] Update next steps

#### In `VerifyContent.tsx` (`app/verify/page.tsx`)
- [ ] Remove `batchId` from tracking
- [ ] Simplify event data (remove batch param)
- [ ] Keep: city, country, state, device type, referrer

#### In `CustomerDataForm.tsx`
- [ ] Remove `batchId` prop
- [ ] Remove batch field from form submission

#### In Firebase
- [ ] Update Firestore security rules (remove batch-specific rules if any)
- [ ] Update `FIREBASE_COLLECTIONS.md` to remove batch references

### Impact
- ‚úÖ Simplifies codebase
- ‚úÖ Removes dependency on ERP system
- ‚úÖ Verify page still tracks all analytics
- ‚úÖ QR codes can be printed immediately (static URL)

---

## üé® Change 2: Replace Custom SVGs

### Current Problem
Custom SVGs in homepage are "ridiculous" and ruining UI:
- `QualitySteelIcon` (steel beam + checkmark)
- `InnovationFactoryIcon` (factory building + gears)
- `TrustCertifiedIcon` (shield + checkmark)

Located in: `app/page.tsx` (lines ~100-200)

### Solution: Use Professional Icon Library

**Option A: Heroicons** (Recommended)
- Free, MIT licensed
- Tailwind-compatible
- High quality, minimal design
- Available via npm or CDN
- Link: https://heroicons.com

**Option B: Feather Icons**
- Free, minimal stroke-based design
- Clean aesthetic
- https://feathericons.com

**Option C: Font Awesome Free**
- Huge library
- Free tier available
- https://fontawesome.com/icons

**Recommendation:** Use **Heroicons** + inline SVG or icon component

### Changes Required

#### Step 1: Replace Icons in Homepage
**File:** `app/page.tsx`

**Current Feature Cards (3 icons):**
```
Quality ‚Üí Replace QualitySteelIcon
- Use: Heroicons "CheckCircle" or "ShieldCheck"

Innovation ‚Üí Replace InnovationFactoryIcon  
- Use: Heroicons "Spark" or "Lightbulb"

Trust ‚Üí Replace TrustCertifiedIcon
- Use: Heroicons "HandThumbUp" or "StarSolid"
```

#### Step 2: Icon Implementation Options

**Option 1: Use Heroicons Package** (Cleanest)
```bash
pnpm add @heroicons/react
```

Then import:
```tsx
import { CheckCircleIcon, SparklesIcon, HandThumbUpIcon } from '@heroicons/react/24/solid'
```

**Option 2: Copy SVG directly** (No dependency)
- Download SVG from heroicons.com
- Paste directly into component
- Keeps bundle size down

**Recommendation:** Use package (Option 1) ‚Äî Heroicons is ~20KB, worth it for consistency

#### Step 3: Update Component Code
Remove custom icon functions:
- [ ] Delete `QualitySteelIcon()` function
- [ ] Delete `InnovationFactoryIcon()` function
- [ ] Delete `TrustCertifiedIcon()` function
- [ ] Delete `IconComponent` component

Replace with clean icon import + inline usage in feature cards section.

#### Step 4: Verify Visual Quality
- [ ] Check homepage on desktop
- [ ] Check on mobile
- [ ] Ensure orange accent colors still work
- [ ] Verify hover states

### Impact
- ‚úÖ Professional, polished appearance
- ‚úÖ Consistent with modern design standards
- ‚úÖ Easier to maintain (no custom SVG logic)
- ‚úÖ Smaller code footprint

---

## üìä Change 3: Build Analytics Dashboard

### Current State
- Verify page logs: city, state, country, deviceType, referrer, timestamp
- Other pages don't log anything
- No admin interface to view data

### Goal: Complete Analytics System

Track **every visit** to **every page** with:
- Page name
- City, State, Country
- Device type (mobile/desktop)
- Timestamp
- Referrer

Then build **Admin Dashboard** to view/analyze:

#### Analytics Tracked (Per Page, Per City, Per Country)

**Collections:**
- `page_views` (already exists, but needs enhancement)
  - pageName, city, state, country, deviceType, timestamp, userAgent
  
- `verify_analytics` (NEW - focused tracking for verify page)
  - Same data as page_views, but dedicated for verify page deep-dive
  - Allows: Which cities scan most? Which countries? Mobile vs desktop?

#### Admin Dashboard Features

**1. Dashboard Home**
- Total visits (all-time, this month, today)
- Total leads captured (customer form submissions)
- Conversion rate (visits ‚Üí form submissions)
- Device breakdown (mobile vs desktop %)

**2. Page Analytics**
- List all pages with visit counts
- Trend graph (visits over time)
- Drill down by page

**3. Geographic Analytics**
- Heatmap of visits by country
- Top 10 countries by visits
- Top 10 cities by visits
- Drill down view: which page did they visit?

**4. Verify Page Deep-Dive** (Most Important)
- Total scans
- Conversion to form submission %
- Top cities scanning
- Top countries scanning
- Mobile vs desktop breakdown
- Time-series graph (scans over time)

**5. Lead Management**
- All customer form submissions
- Filterable by: date, city, country, use case
- Export to CSV (for sales team)
- Contact info (phone, email, name)

**6. Traffic Sources**
- Referrer analysis (where do visitors come from?)
- Direct vs referred traffic
- Top referrers

### Implementation Plan

#### Phase 1: Enhance Tracking (1-2 days)
**File Changes:**

1. **lib/analytics.ts** ‚Äî Add tracking functions
   ```tsx
   trackPageView(pageName, location)
   trackVerifyPageView(location)
   trackFormSubmission(data, location)
   ```

2. **app/layout.tsx** ‚Äî Track all pages
   ```tsx
   useEffect(() => {
     trackPageView(currentPage, userLocation)
   }, [])
   ```

3. **Firebase** ‚Äî Update collections
   - Ensure `page_views` has all required fields
   - Create `verify_analytics` collection (optional, but cleaner for analysis)

#### Phase 2: Build Admin Dashboard (1-2 weeks)
**New Pages/Components:**

1. **`/admin`** ‚Äî Login page (Firebase Auth)
   - Email/password login for admin users
   - Verifies against Firebase custom claims

2. **`/admin/dashboard`** ‚Äî Main dashboard
   - Cards showing key metrics
   - Graphs using a library (Chart.js or Recharts)
   - Summary stats

3. **`/admin/analytics/pages`** ‚Äî Page analytics
   - Table of all pages with visit counts
   - Sortable, filterable
   - Link to drill-down view

4. **`/admin/analytics/geographic`** ‚Äî Geographic heatmap
   - World map showing visit density
   - List of top countries/cities
   - Drill-down to specific location

5. **`/admin/analytics/verify`** ‚Äî Verify page deep-dive
   - Dedicated page for QR/verify analytics
   - Top metrics specific to verification flow
   - Conversion funnel (view ‚Üí form submit)

6. **`/admin/leads`** ‚Äî Lead management
   - All customer submissions in a table
   - Filters: date range, city, country, use case
   - Export to CSV button
   - Contact info visible

#### Phase 3: UI Library for Charts (1 day)
Install a charting library:

**Option A: Recharts** (Recommended for Next.js)
```bash
pnpm add recharts
```
- React-native, easy to use
- Good performance
- Works great with Tailwind

**Option B: Chart.js**
```bash
pnpm add chart.js react-chartjs-2
```
- Very popular
- More configuration options

**Recommendation:** Recharts (simpler, React-native)

#### Phase 4: Authentication (2-3 days)
Secure admin dashboard with Firebase Auth:

1. Create Firebase custom claims (mark as admin)
2. Protect `/admin` routes with middleware
3. Simple login page (email/password)
4. Logout button in dashboard

### Database Structure

**Firestore Collections:**

```
page_views/ {
  pageName: "products",
  city: "Bangalore",
  state: "Karnataka",
  country: "India",
  deviceType: "mobile",
  userAgent: "...",
  timestamp: serverTimestamp(),
  referrer: "google.com"
}

verify_analytics/ {
  # Same as page_views, but specifically for verify page
  # Allows easy filtering for verify-specific analysis
}

customer_data/ {
  name: "Rajesh Kumar",
  email: "rajesh@company.com",
  phone: "+919876543210",
  city: "Bangalore",
  state: "Karnataka",
  country: "India",
  useCase: "construction",
  quantityNeeded: "500 kg",
  submittedAt: serverTimestamp()
}
```

### Firestore Security Rules Update

```firestore
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /page_views/{document=**} {
      allow create: if true;  // Public can log views
      allow read: if request.auth != null && hasRole(request.auth.uid, 'admin');
    }
    
    match /verify_analytics/{document=**} {
      allow create: if true;
      allow read: if request.auth != null && hasRole(request.auth.uid, 'admin');
    }
    
    match /customer_data/{document=**} {
      allow create: if true;
      allow read: if request.auth != null && hasRole(request.auth.uid, 'admin');
    }
  }
}

function hasRole(uid, role) {
  return get(/databases/$(database)/documents/users/$(uid)).data.roles[role] == true;
}
```

---

## üîê Change 4: Fix Security Issue

### Problem
Firebase API keys exposed in git history (commits e9dde95, 13ec800).

### Solution

#### Step 1: Rotate Firebase Keys (30 min)
1. Go to Firebase Console ‚Üí Project Settings
2. Find "Service Accounts" ‚Üí "Web" section
3. Regenerate Web API Key
4. Copy new credentials

#### Step 2: Update Local Environment (5 min)
1. Update `.env.local` with new keys
2. Test locally: `pnpm dev`
3. Verify Firebase connection works

#### Step 3: Update Vercel Environment (5 min)
1. Go to Vercel dashboard ‚Üí Settings ‚Üí Environment Variables
2. Update each variable:
   - NEXT_PUBLIC_FIREBASE_API_KEY
   - NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN
   - NEXT_PUBLIC_FIREBASE_PROJECT_ID
   - etc.
3. Trigger redeploy

#### Step 4: Verify Production (5 min)
1. Visit https://aadinathindustries.in/verify
2. Check browser console (no errors)
3. Check Firebase Console for new events
4. Monitor for suspicious activity

#### Step 5: Monitor & Document (ongoing)
- [ ] Watch Firebase usage for next 48h
- [ ] Check for unauthorized access patterns
- [ ] Document in SECURITY.md when keys were rotated
- [ ] Optional: Set up Firebase billing alerts

### Impact
- ‚úÖ Credentials invalidated (old keys useless)
- ‚úÖ Production secure
- ‚úÖ No sensitive data in git history going forward

---

## üìÖ Implementation Timeline

| Change | Effort | Days | Order | Blocker? |
|--------|--------|------|-------|----------|
| 1. Remove Batch System | Small | 1 | First | No |
| 2. Replace SVGs | Small | 0.5 | Second | No |
| 3. Analytics & Dashboard | Large | 10-14 | Third | No |
| 4. Security Keys | Small | 0.5 | Anytime | üî¥ YES |

### Recommended Order
1. **Today:** Rotate Firebase keys (unblock production)
2. **Feb 9-10:** Remove batch system + replace SVGs (quick wins)
3. **Feb 10-23:** Build analytics system (biggest task)

---

## ‚úÖ Deliverables

### By Feb 10 (End of Day)
- [ ] Batch system removed from code & docs
- [ ] Custom SVGs replaced with Heroicons
- [ ] Firebase keys rotated
- [ ] PROGRESS.md updated
- [ ] All tests passing

### By Feb 23
- [ ] Page tracking on all pages
- [ ] Admin dashboard built (all 6 sections)
- [ ] Firebase security rules updated
- [ ] Admin auth working
- [ ] Documentation updated
- [ ] Tested in production

---

## üìù Documentation Updates Needed

- [ ] **VERIFICATION_SETUP.md** ‚Äî Remove batch system
- [ ] **PROGRESS.md** ‚Äî Update timeline & status
- [ ] **OVERVIEW.md** ‚Äî Add admin dashboard info
- [ ] **REQUIREMENTS.md** ‚Äî Add admin dashboard specs
- [ ] **NEW: ANALYTICS.md** ‚Äî Document analytics system & dashboard
- [ ] **SECURITY.md** ‚Äî Note when keys were rotated

---

## ‚úÖ Answers (Feb 9, 14:48)

1. **Admin Dashboard Access:** Firebase Auth (simple login with email/password)
2. **Geographic Data:** Charts/heatmap visualization (no map needed)
3. **CSV Export:** Manual button (user initiates export)
4. **Analytics History:** Keep ALL data (no archival)
5. **Team Access:** Adi only (single user for now)

---

**Next Step:** Get Adi's approval on this plan, then start with Step 1 (Remove Batch System).
